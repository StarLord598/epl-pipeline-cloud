%%{init: {'theme': 'dark', 'themeVariables': {'fontSize': '16px', 'primaryColor': '#38003c', 'lineColor': '#00ff85'}}}%%

flowchart LR
    subgraph SRC["ğŸŒ Sources"]
        direction TB
        A1["âš½ football-data.org<br/><b>Live API</b>"]
        A2["ğŸ“¦ StatsBomb<br/><b>Historical</b>"]
    end

    subgraph AIR["ğŸ”„ Airflow"]
        direction TB
        B1["<b>live_poll_15m</b><br/>â° Every 15 min"]
        B2["<b>hourly_refresh</b><br/>â° Every hour"]
        B3["<b>dbt_transform</b><br/>â° Every 30 min"]
        B4["<b>daily_reconcile</b><br/>â° 2 AM daily"]
    end

    subgraph DWH["ğŸ—ï¸ DuckDB â€” Medallion"]
        direction TB
        C1["ğŸ¥‰ <b>Raw</b><br/>matches Â· events Â· lineups<br/>live_matches Â· live_standings"]
        C2["ğŸ¥ˆ <b>Staging</b><br/>stg_matches Â· stg_standings<br/>stg_events Â· silver_live"]
        C3["ğŸ¥‡ <b>Mart</b><br/>league_table Â· top_scorers<br/>recent_results Â· live_monitor"]
    end

    subgraph OUT["ğŸ“Š Serving"]
        direction TB
        D1["ğŸ“„ JSON Export"]
        D2["ğŸ–¥ï¸ Next.js<br/>Dashboard"]
    end

    A1 -->|"every 15 min"| B1
    A1 -->|"hourly"| B2
    A2 -->|"daily"| B4
    B1 --> C1
    B2 --> C1
    B4 --> C1
    B3 --> C2
    C1 -->|"dbt"| C2
    C2 -->|"dbt"| C3
    C3 --> D1
    D1 --> D2

    style SRC fill:#0046A7,stroke:#00c8ff,color:#fff
    style AIR fill:#38003c,stroke:#f97316,color:#fff
    style DWH fill:#1a1a2e,stroke:#FFD700,color:#fff
    style OUT fill:#0f4c3a,stroke:#00ff85,color:#fff
